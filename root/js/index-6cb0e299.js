import{q as e,r as o,d as a,h as t,w as s,t as n,v as l,T as r,J as c,K as i,g as u,k as v,j as d,p,L as f,F as h,x as m,n as y}from"./vue-72c29318.js";import{i as w,n as b,e as I,a as k,t as x,u as z,o as S,g as B,p as g,c as A,b as O,d as C,w as L,m as P,f as j,I as X}from"./index-cbd6929f.js";const Y="van-hairline-unset--top-bottom",E="van-haptics-feedback";function R(o){const a=e();a&&I(a.proxy,o)}const T={show:Boolean,zIndex:k,overlay:x,duration:k,teleport:[String,Object],lockScroll:x,lazyRender:x,beforeClose:Function,overlayStyle:Object,overlayClass:z,transitionAppear:Boolean,closeOnClickOverlay:x};function H(){const e=o(0),a=o(0),t=o(0),s=o(0),n=o(0),l=o(0),r=o(""),c=()=>{t.value=0,s.value=0,n.value=0,l.value=0,r.value=""};return{move:o=>{const c=o.touches[0];t.value=(c.clientX<0?0:c.clientX)-e.value,s.value=c.clientY-a.value,n.value=Math.abs(t.value),l.value=Math.abs(s.value);var i,u;(!r.value||n.value<10&&l.value<10)&&(r.value=(i=n.value,u=l.value,i>u?"horizontal":u>i?"vertical":""))},start:o=>{c(),e.value=o.touches[0].clientX,a.value=o.touches[0].clientY},reset:c,startX:e,startY:a,deltaX:t,deltaY:s,offsetX:n,offsetY:l,direction:r,isVertical:()=>"vertical"===r.value,isHorizontal:()=>"horizontal"===r.value}}let D=0;function $(e){const a=o(!1);return s(e,(e=>{e&&(a.value=e)}),{immediate:!0}),e=>()=>a.value?e():null}const F=Symbol(),[K,M]=A("overlay");const N=L(n({name:K,props:{show:Boolean,zIndex:k,duration:k,className:z,lockScroll:x,lazyRender:x,customStyle:Object},setup(e,{slots:o}){const a=$((()=>e.show||!e.lazyRender)),t=e=>{g(e,!0)},s=a((()=>{var a;const s=I(O(e.zIndex),e.customStyle);return C(e.duration)&&(s.animationDuration=`${e.duration}s`),c(l("div",{style:s,"class":[M(),e.className],onTouchmove:e.lockScroll?t:b},[null==(a=o["default"])?void 0:a.call(o)]),[[i,e.show]])}));return()=>l(r,{name:"van-fade",appear:!0},{"default":s})}})),V=I({},T,{round:Boolean,position:P("center"),closeIcon:P("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:P("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[q,J]=A("popup");let G=2e3;const Q=L(n({name:q,inheritAttrs:!1,props:V,emits:["open","close","opened","closed","keydown","update:show","click-overlay","click-close-icon"],setup(e,{emit:n,attrs:I,slots:k}){let x,z;const A=o(),O=o(),L=$((()=>e.show||!e.lazyRender)),P=u((()=>{const o={zIndex:A.value};if(C(e.duration)){o["center"===e.position?"animationDuration":"transitionDuration"]=`${e.duration}s`}return o})),Y=()=>{x||(void 0!==e.zIndex&&(G=+e.zIndex),x=!0,A.value=++G,n("open"))},E=()=>{x&&function(e,{args:o=[],done:a,canceled:t}){if(e){const s=e.apply(null,o);w(s)?s.then((e=>{e?a():t&&t()}))["catch"](b):s?a():t&&t()}else a()}(e.beforeClose,{done(){x=!1,n("close"),n("update:show",!1)}})},T=o=>{n("click-overlay",o),e.closeOnClickOverlay&&E()},K=()=>{if(e.overlay)return l(N,{show:e.show,"class":e.overlayClass,zIndex:A.value,duration:e.duration,customStyle:e.overlayStyle,onClick:T},{"default":k["overlay-content"]})},M=e=>{n("click-close-icon",e),E()},V=()=>{if(e.closeable)return l(X,{role:"button",tabindex:0,name:e.closeIcon,"class":[J("close-icon",e.closeIconPosition),"van-haptics-feedback"],classPrefix:e.iconPrefix,onClick:M},null)},q=()=>n("opened"),Q=()=>n("closed"),U=e=>n("keydown",e),W=L((()=>{var o;const{round:a,position:t,safeAreaInsetTop:s,safeAreaInsetBottom:n}=e;return c(l("div",m({ref:O,style:P.value,"class":[J({round:a,[t]:t}),{"van-safe-area-top":s,"van-safe-area-bottom":n}],onKeydown:U},I),[null==(o=k["default"])?void 0:o.call(k),V()]),[[i,e.show]])})),Z=()=>{const{position:o,transition:a,transitionAppear:t}=e;return l(r,{name:a||("center"===o?"van-fade":`van-popup-slide-${o}`),appear:t,onAfterEnter:q,onAfterLeave:Q},{"default":W})};return s((()=>e.show),(e=>{e&&!x&&(Y(),0===I.tabindex&&y((()=>{var e;null==(e=O.value)||e.focus()}))),!e&&x&&(x=!1,n("close"))})),R({popupRef:O}),function(e,o){const n=H(),l=o=>{n.move(o);const a=n.deltaY.value>0?"10":"01",t=B(o.target,e.value),{scrollHeight:s,offsetHeight:l,scrollTop:r}=t;let c="11";0===r?c=l>=s?"00":"01":r+l>=s&&(c="10"),"11"===c||!n.isVertical()||parseInt(c,2)&parseInt(a,2)||g(o,!0)},r=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",l,{passive:!1}),D||document.body.classList.add("van-overflow-hidden"),D++},c=()=>{D&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",l),D--,D||document.body.classList.remove("van-overflow-hidden"))},i=()=>o()&&c();S((()=>o()&&r())),a(i),t(i),s(o,(e=>{e?r():c()}))}(O,(()=>e.show&&e.lockScroll)),j("popstate",(()=>{e.closeOnPopstate&&(E(),z=!1)})),v((()=>{e.show&&Y()})),d((()=>{z&&(n("update:show",!0),z=!1)})),a((()=>{e.show&&(E(),z=!0)})),p(F,(()=>e.show)),()=>e.teleport?l(f,{to:e.teleport},{"default":()=>[K(),Z()]}):l(h,null,[K(),Z()])}}));export{Y as B,E as H,Q as P,H as a,R as u};